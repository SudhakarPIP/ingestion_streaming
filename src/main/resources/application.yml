spring:
  application:
    name: ingestion-streaming-service
  
  datasource:
    url: jdbc:mysql://localhost:3306/pip?createDatabaseIfNotExist=true&useSSL=false&serverTimezone=UTC
    username: root
    password: Svmr12!@
    driver-class-name: com.mysql.cj.jdbc.Driver
  
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
  
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.MySQLDialect

server:
  port: 8080

bigquery:
  # REQUIRED: Set your actual GCP project ID
  # Option 1: Set environment variable BIGQUERY_PROJECT_ID
  # Option 2: Replace 'your-gcp-project-id' below with your actual project ID
  project-id: ${BIGQUERY_PROJECT_ID:your-gcp-project-id}
  dataset: ${BIGQUERY_DATASET:analytics}
  table: ${BIGQUERY_TABLE:events_curated}
  # REQUIRED: Path to GCP service account JSON key file
  # Option 1: Set environment variable GOOGLE_APPLICATION_CREDENTIALS
  # Option 2: Provide full path to JSON file below (e.g., C:\path\to\credentials.json)
  credentials-path: ${GOOGLE_APPLICATION_CREDENTIALS:}

worker:
  batch-size: ${WORKER_BATCH_SIZE:200}
  lock-ttl-seconds: ${WORKER_LOCK_TTL_SECONDS:300}
  instance-id: ${WORKER_INSTANCE_ID:${HOSTNAME:default-instance}}
  max-retry-count: 5

scheduler:
  outbox:
    enabled: true
    fixed-delay: 5000
    initial-delay: 10000

management:
  endpoints:
    web:
      exposure:
        include: health,metrics,prometheus,info
  endpoint:
    health:
      show-details: always
  metrics:
    export:
      prometheus:
        enabled: true
    tags:
      application: ${spring.application.name}

logging:
  level:
    com.example.ingestion: INFO
    org.springframework.web: INFO
    org.hibernate.SQL: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{correlationId}] [%X{tenantId}] [%X{eventId}] [%X{outboxId}] %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%X{correlationId}] [%X{tenantId}] [%X{eventId}] [%X{outboxId}] %logger{36} - %msg%n"

